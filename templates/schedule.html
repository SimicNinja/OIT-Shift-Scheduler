{{define "title"}}Schedule{{end}}

{{define "main"}}
	{{if .ReadOnly}}
		<h1>Viewing {{.User.Username}}'s Schedule</h1>	
	{{else}}
		<h1>Welcome {{.User.Username}}! Select Your Desired Schedule</h1>
	{{end}}

	{{if not .ReadOnly}}
		<button id = "selectBtn">Select Mode</button>
	{{end}}
	
	<table class = "week">
		<tr>
			<th id = "dayColumn">Day</th>
			{{range .Week.Hours}}
				<th class = "hourColumn">{{.Label}}</th>
			{{end}}
			<th id = "totalColumn">Totals</th>
		</tr>
		{{range .Week.Days}}
			{{$day := .}}
			<tr>
				<td class = "daySlot">{{.}}</td>
				{{range $.Week.Hours}}
					{{$hour := .Value24}}
					<td>
						<div class = "hourSlot">
						{{range $.Week.Minutes}}
							<div class = "minuteSlot" day = "{{$day}}" hour = "{{$hour}}" minute = "{{.}}">
								{{printf ":%02d" .}}
							</div>
						{{end}}
						</div>
					</td>
				{{end}}
				<td id = "{{.}}Total">0hrs 0mins</td>
			</tr>
		{{end}}
	</table>

	<h2 id = "weekTotal">Weekly Total: </h2>
	
	{{if not .ReadOnly}}
		<button 
			id = "submitBtn"
			hx-post = "/submit" 
			hx-trigger = "click" 
			hx-target = "#submitStatus"
			hx-ext = "json-enc"
			hx-vals = 'js:{"Schedule": buildSchedulePayload()}'>
			Submit Schedule
		</button>
	{{end}}

	<div id = "submitStatus"></div>
{{end}}

{{define "script"}}
	<script>
		window.preloadedSchedule = {{if .User.Schedule}}
			{{.User.Schedule | toJson}}
		{{else}}
			{"Shifts": []}
		{{end}};
		window.readOnlyMode = {{.ReadOnly}};
	</script>

	<script src = "/static/schedule.js"></script>
{{end}}